<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1599px" preserveAspectRatio="none" style="width:1021px;height:1599px;" version="1.1" viewBox="0 0 1021 1599" width="1021px" zoomAndPan="magnify"><defs><filter height="300%" id="f7ez9mlson4ql" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="118.5527" style="stroke:#A80036;stroke-width:1.0;" width="10" x="425" y="1119.8418"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="103.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="425" y="1427.5684"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="193.1738" style="stroke:#000000;stroke-width:2.0;" width="448" x="10" y="57.4883"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="134.5527" style="stroke:#000000;stroke-width:2.0;" width="533" x="10" y="264.6621"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="91.2422" style="stroke:#000000;stroke-width:2.0;" width="287" x="402" y="413.2148"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="208.4844" style="stroke:#000000;stroke-width:2.0;" width="997" x="10" y="812.8047"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="285.0371" style="stroke:#000000;stroke-width:2.0;" width="679" x="10" y="1035.2891"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="149.8633" style="stroke:#000000;stroke-width:2.0;" width="679" x="10" y="1388.9473"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="49" x2="49" y1="40.4883" y2="1555.8105"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="430" x2="430" y1="40.4883" y2="1555.8105"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="495" x2="495" y1="40.4883" y2="1555.8105"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="621" x2="621" y1="40.4883" y2="1555.8105"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="776" x2="776" y1="40.4883" y2="1555.8105"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="935" x2="935" y1="40.4883" y2="1555.8105"/><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="27" y="25.5352">Client</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="20" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="27" y="1575.3457">Client</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="32" x="412" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="18" x="419" y="25.5352">AP</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="32" x="412" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="18" x="419" y="1575.3457">AP</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="71" x="458" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="465" y="25.5352">Gateway</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="71" x="458" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="465" y="1575.3457">Gateway</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="112" x="563" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="570" y="25.5352">RADIUS Server</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="112" x="563" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98" x="570" y="1575.3457">RADIUS Server</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="170" x="689" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="696" y="25.5352">External Captive Portal</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="170" x="689" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="696" y="1575.3457">External Captive Portal</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="120" x="873" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="880" y="25.5352">OAuth provider</text><rect fill="#FEFECE" filter="url(#f7ez9mlson4ql)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="120" x="873" y="1554.8105"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="880" y="1575.3457">OAuth provider</text><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="118.5527" style="stroke:#A80036;stroke-width:1.0;" width="10" x="425" y="1119.8418"/><rect fill="#FFFFFF" filter="url(#f7ez9mlson4ql)" height="103.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="425" y="1427.5684"/><path d="M10,57.4883 L296,57.4883 L296,64.4883 L286,74.4883 L10,74.4883 L10,57.4883 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="193.1738" style="stroke:#000000;stroke-width:2.0;" width="448" x="10" y="57.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="241" x="25" y="71.0566">802.11 Open System Authentcation</text><polygon fill="#A80036" points="418,92.1094,428,96.1094,418,100.1094,422,96.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="424" y1="96.1094" y2="96.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="91.3672">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="69" y="91.3672">Probe-Request</text><polygon fill="#A80036" points="60,121.4199,50,125.4199,60,129.4199,56,125.4199" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="54" x2="429" y1="125.4199" y2="125.4199"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="66" y="120.6777">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="79" y="120.6777">Probe-Response</text><polygon fill="#A80036" points="418,150.7305,428,154.7305,418,158.7305,422,154.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="424" y1="154.7305" y2="154.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="149.9883">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233" x="69" y="149.9883">Open System Authentication Request</text><polygon fill="#A80036" points="60,180.041,50,184.041,60,188.041,56,184.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="54" x2="429" y1="184.041" y2="184.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="66" y="179.2988">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="79" y="179.2988">Open System Authentication Response</text><polygon fill="#A80036" points="418,209.3516,428,213.3516,418,217.3516,422,213.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="424" y1="213.3516" y2="213.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="208.6094">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="69" y="208.6094">Assoication Request</text><polygon fill="#A80036" points="60,238.6621,50,242.6621,60,246.6621,56,242.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="429" y1="242.6621" y2="242.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="66" y="237.9199">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="79" y="237.9199">Association Response</text><path d="M10,264.6621 L205,264.6621 L205,271.6621 L195,281.6621 L10,281.6621 L10,264.6621 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="134.5527" style="stroke:#000000;stroke-width:2.0;" width="533" x="10" y="264.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="150" x="25" y="278.2305">DHCP IP Configuration</text><polygon fill="#A80036" points="483.5,299.2832,493.5,303.2832,483.5,307.2832,487.5,303.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="489.5" y1="303.2832" y2="303.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="298.541">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="69" y="298.541">DHCP Discovery</text><polygon fill="#A80036" points="60,328.5938,50,332.5938,60,336.5938,56,332.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="54" x2="494.5" y1="332.5938" y2="332.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="66" y="327.8516">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="79" y="327.8516">DHCP Offer</text><polygon fill="#A80036" points="483.5,357.9043,493.5,361.9043,483.5,365.9043,487.5,361.9043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="489.5" y1="361.9043" y2="361.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="56" y="357.1621">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="69" y="357.1621">DHCP Request</text><polygon fill="#A80036" points="60,387.2148,50,391.2148,60,395.2148,56,391.2148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="54" x2="494.5" y1="391.2148" y2="391.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="386.4727">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64" x="88" y="386.4727">DHCP Ack</text><path d="M402,413.2148 L636,413.2148 L636,420.2148 L626,430.2148 L402,430.2148 L402,413.2148 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="91.2422" style="stroke:#000000;stroke-width:2.0;" width="287" x="402" y="413.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189" x="417" y="426.7832">RADIUS MAC Authentication</text><polygon fill="#A80036" points="609,463.1465,619,467.1465,609,471.1465,613,467.1465" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="430" x2="615" y1="467.1465" y2="467.1465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="437" y="454.749">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="459" y="447.0938">Access-Request:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="459" y="462.4043">MAC-Authentication</text><polygon fill="#A80036" points="441,492.457,431,496.457,441,500.457,437,496.457" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="435" x2="620" y1="496.457" y2="496.457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="447" y="491.7148">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="469" y="491.7148">Access-Reject:</text><path d="M54,516.457 L54,556.457 L356,556.457 L356,526.457 L346,516.457 L54,516.457 " fill="#FBFB77" filter="url(#f7ez9mlson4ql)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M346,516.457 L346,526.457 L356,526.457 L346,516.457 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="60" y="534.0254">The client only can access the Internet hosts</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222" x="60" y="549.3359">that are listed in the walled garden.</text><polygon fill="#A80036" points="418,583.3887,428,587.3887,418,591.3887,422,587.3887" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="424" y1="587.3887" y2="587.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="582.6465">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="78" y="582.6465">HTTP Request</text><polygon fill="#A80036" points="60,612.6992,50,616.6992,60,620.6992,56,616.6992" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="429" y1="616.6992" y2="616.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="611.957">14</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="88" y="611.957">HTTP Response: 302</text><polygon fill="#A80036" points="764,749.1836,774,753.1836,764,757.1836,768,753.1836" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="770" y1="753.1836" y2="753.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="694.8545">15</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="78" y="641.2676">HTTP GET:Splash Page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="78" y="656.5781">With URL parameters:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="78" y="671.8887">continue_url,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="78" y="687.1992">login_url,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="78" y="702.5098">ap_mac,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="78" y="717.8203">ap_name,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="78" y="733.1309">ap_tags,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="78" y="748.4414">mauth</text><polygon fill="#A80036" points="60,793.8047,50,797.8047,60,801.8047,56,797.8047" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="775" y1="797.8047" y2="797.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="785.4072">16</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="88" y="777.752">HTTP Responst:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="88" y="793.0625">Custom Splash Page</text><path d="M10,812.8047 L641,812.8047 L641,819.8047 L631,829.8047 L10,829.8047 L10,812.8047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="208.4844" style="stroke:#000000;stroke-width:2.0;" width="997" x="10" y="812.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="586" x="25" y="826.373">Authentication proccess customized by the External Captive Portal, for example OAuth</text><polygon fill="#A80036" points="764,847.4258,774,851.4258,764,855.4258,768,851.4258" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="770" y1="851.4258" y2="851.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="846.6836">17</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="78" y="846.6836">OAuth Request</text><polygon fill="#A80036" points="60,876.7363,50,880.7363,60,884.7363,56,880.7363" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="775" y1="880.7363" y2="880.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="875.9941">18</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="88" y="875.9941">HTTP Response: 200</text><polygon fill="#A80036" points="923,906.0469,933,910.0469,923,914.0469,927,910.0469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="929" y1="910.0469" y2="910.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="905.3047">19</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="78" y="905.3047">HTTP Request: Authentication</text><polygon fill="#A80036" points="60,935.3574,50,939.3574,60,943.3574,56,939.3574" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="934" y1="939.3574" y2="939.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="934.6152">20</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="88" y="934.6152">HTTP Response: 302</text><polygon fill="#A80036" points="764,964.668,774,968.668,764,972.668,768,968.668" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="770" y1="968.668" y2="968.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="963.9258">21</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="78" y="963.9258">HTTP GET: OAuth access token</text><polygon fill="#A80036" points="60,1009.2891,50,1013.2891,60,1017.2891,56,1013.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="775" y1="1013.2891" y2="1013.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="1000.8916">22</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="88" y="993.2363">HTTP Response:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230" x="88" y="1008.5469">Accept with username and password</text><path d="M10,1035.2891 L244,1035.2891 L244,1042.2891 L234,1052.2891 L10,1052.2891 L10,1035.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="285.0371" style="stroke:#000000;stroke-width:2.0;" width="679" x="10" y="1035.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="189" x="25" y="1048.8574">RADIUS User Authentication</text><polygon fill="#A80036" points="413,1115.8418,423,1119.8418,413,1123.8418,417,1119.8418" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="419" y1="1119.8418" y2="1119.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="1092.1338">23</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="78" y="1069.168">HTTP POST: /captive_portal.cpp?mauth=</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="335" x="78" y="1084.4785">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="82" y="1099.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="78" y="1115.0996">username=&amp;password=&amp;success_url=</text><polygon fill="#A80036" points="609,1160.4629,619,1164.4629,609,1168.4629,613,1164.4629" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="435" x2="615" y1="1164.4629" y2="1164.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="442" y="1152.0654">24</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="464" y="1144.4102">Access-Request:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="464" y="1159.7207">username, password</text><polygon fill="#A80036" points="446,1205.084,436,1209.084,446,1213.084,442,1209.084" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="440" x2="620" y1="1209.084" y2="1209.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="1196.6865">25</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="474" y="1189.0313">Access-Response:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="474" y="1204.3418">Accept</text><polygon fill="#A80036" points="60,1234.3945,50,1238.3945,60,1242.3945,56,1238.3945" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="429" y1="1238.3945" y2="1238.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="1233.6523">26</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298" x="88" y="1233.6523">HTTP Response: Login success with logout URL</text><polygon fill="#A80036" points="609,1279.0156,619,1283.0156,609,1287.0156,613,1283.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="430" x2="615" y1="1283.0156" y2="1283.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="437" y="1270.6182">27</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="459" y="1262.9629">Accounting-Request:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="459" y="1278.2734">start</text><polygon fill="#A80036" points="441,1308.3262,431,1312.3262,441,1316.3262,437,1312.3262" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="435" x2="620" y1="1312.3262" y2="1312.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="447" y="1307.584">28</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="469" y="1307.584">Accounting-Response</text><path d="M54,1332.3262 L54,1372.3262 L350,1372.3262 L350,1342.3262 L340,1332.3262 L54,1332.3262 " fill="#FBFB77" filter="url(#f7ez9mlson4ql)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M340,1332.3262 L340,1342.3262 L350,1342.3262 L340,1332.3262 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262" x="60" y="1349.8945">The client can access the Internet directly</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275" x="60" y="1365.2051">after pass the captive portal authentication.</text><path d="M10,1388.9473 L137,1388.9473 L137,1395.9473 L127,1405.9473 L10,1405.9473 L10,1388.9473 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="149.8633" style="stroke:#000000;stroke-width:2.0;" width="679" x="10" y="1388.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82" x="25" y="1402.5156">User Logout</text><polygon fill="#A80036" points="413,1423.5684,423,1427.5684,413,1431.5684,417,1427.5684" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="49" x2="419" y1="1427.5684" y2="1427.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="56" y="1422.8262">29</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="78" y="1422.8262">HTTP GET /logout.cpp?mauth=</text><polygon fill="#A80036" points="609,1468.1895,619,1472.1895,609,1476.1895,613,1472.1895" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="435" x2="615" y1="1472.1895" y2="1472.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="442" y="1459.792">30</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="464" y="1452.1367">Accounting-Request:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="464" y="1467.4473">stop</text><polygon fill="#A80036" points="446,1497.5,436,1501.5,446,1505.5,442,1501.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="440" x2="620" y1="1501.5" y2="1501.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="452" y="1496.7578">31</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="474" y="1496.7578">Accounting-Response</text><polygon fill="#A80036" points="60,1526.8105,50,1530.8105,60,1534.8105,56,1530.8105" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="54" x2="429" y1="1530.8105" y2="1530.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="66" y="1526.0684">32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265" x="88" y="1526.0684">HTTP Response: Logout logout successful</text><!--MD5=[3a03508450b96d6e5aa066c9483a5f85]
@startuml
autonumber
group 802.11 Open System Authentcation
  Client -> AP: Probe-Request
  AP - -> Client: Probe-Response
  Client -> AP: Open System Authentication Request
  AP - -> Client: Open System Authentication Response
  Client -> AP: Assoication Request
  AP -> Client: Association Response
end
group DHCP IP Configuration
  Client -> Gateway: DHCP Discovery
  Gateway - -> Client: DHCP Offer
  Client -> Gateway: DHCP Request
  Gateway - -> Client: DHCP Ack
end
group RADIUS MAC Authentication
  AP -> "RADIUS Server": Access-Request:\nMAC-Authentication
  "RADIUS Server" - -> AP: Access-Reject:
end
note right of Client: The client only can access the Internet hosts\nthat are listed in the walled garden.
Client -> AP: HTTP Request
AP -> Client: HTTP Response: 302
Client -> "External Captive Portal": HTTP GET:Splash Page\nWith URL parameters:\ncontinue_url,\nlogin_url,\nap_mac,\nap_name,\nap_tags,\nmauth
"External Captive Portal" -> Client: HTTP Responst:\nCustom Splash Page
group Authentication proccess customized by the External Captive Portal, for example OAuth
  Client -> "External Captive Portal": OAuth Request
  "External Captive Portal" -> Client: HTTP Response: 200
  Client -> "OAuth provider": HTTP Request: Authentication
  "OAuth provider" -> Client: HTTP Response: 302
  Client -> "External Captive Portal": HTTP GET: OAuth access token
"External Captive Portal" -> Client: HTTP Response:\nAccept with username and password
end
group RADIUS User Authentication
  Client -> AP: HTTP POST: /captive_portal.cpp?mauth=\nContent-Type: application/x-www-form-urlencoded\n\nusername=&password=&success_url=
  activate AP
  AP -> "RADIUS Server": Access-Request:\nusername, password
  "RADIUS Server" -> AP: Access-Response:\nAccept
  AP -> Client: HTTP Response: Login success with logout URL
  deactivate AP
  AP -> "RADIUS Server": Accounting-Request:\nstart
  "RADIUS Server" -> AP: Accounting-Response
end
note right of Client: The client can access the Internet directly\nafter pass the captive portal authentication.
group User Logout

  Client -> AP: HTTP GET /logout.cpp?mauth=
  activate AP
  AP -> "RADIUS Server": Accounting-Request:\nstop
  "RADIUS Server" -> AP: Accounting-Response
  AP -> Client: HTTP Response: Logout logout successful
  deactivate AP
end
@enduml

PlantUML version 1.2021.00(Sun Jan 10 18:25:05 CST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: TW
--></g></svg>